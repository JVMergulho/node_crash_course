<!DOCTYPE html>
<html lang="en">
    <%- include('../partials/head.ejs', {title}) %>
<body>
    <%- include('../partials/nav.ejs') %>

    <div id="search">
        <input type="text" id="txt_search" placeholder="Buscar blogs..."/>
    </div>

    <div class="blogs content">
        <h2>Todos os blogs</h2>
        <% if(blogs.length > 0) { %>
            <%   blogs.forEach(blog => { %>
                    
                    <a href="/blogs/<%= blog._id%>" class="single_blog">
                        <h3 class="title"> <%= blog.title %> </h3>
                    </a>
                    <p class="snippet"> <%= blog.snippet%> </p>
        
            <%  }) %>
            <%}  else { %>
                    <p>Ainda não há blog cadastrados</p>
            <%  } %>
    </div>

    <%- include('../partials/footer.ejs') %>

</body>
<script>
    document.getElementById('txt_search').addEventListener('keydown', function (e) {
        if (e.key === 'Enter') {

            const searchTerm = document.getElementById('txt_search').value;
            console.log('Searching for:', searchTerm);

            const encodedSearchTerm = encodeURIComponent(searchTerm);

            const url = `/blogs/search?searchTerm=${encodedSearchTerm}`

            fetch(url, {
                method: 'GET',
            })
            .catch(error => {
                console.error('Error:', error)
            })
        }
    });
</script>
</html>